<!doctype html>
<html lang="zh-Hans">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<link rel="stylesheet" href="./resources/style/item.css"/>
    <script>
        var itemTag;
        var itemInfo;
        var itemSrcLnk;
        var itemConfig;
        var itemMain;
        var codeTry;
        var loadNum = window.location.href.split("?")[1];
        window.onload = function(){if(loadNum){
            var Sprofile = document.createElement("script");
            Sprofile.type = "text/javascript";
            Sprofile.src = "./resources/items/item" + loadNum + "/index.js"
            document.body.appendChild(Sprofile);
                Sprofile.onload = function(){
                if(itemLoaded){
                    if(itemFromPart[0]=="steam") itemFromPart = "Steam 游戏"
                    if(itemFromPart[0]=="web") itemFromPart = "网页设计经验"
                    if(itemFromPart[0]=="push") itemFromPart = "推荐内容"
                    document.title += itemIndexTitle + " - " + itemFromPart + "相关";
                    document.getElementById("headerTitle").innerHTML += itemFromPart + "相关";
                    document.getElementById("articleTopImg").src = "./resources/items/item" + loadNum + "/media/" + itemIndexImage;
                    document.getElementById("articleTitle").innerHTML = itemIndexTitle;

                    if(itemConfig){
                        var itemCfgList = itemConfig.split("\t");
                        for (l = 0; l < itemCfgList.length; l ++){
                            var itemCfgItemList = itemCfgList[l].split("\n");
                            if (itemCfgItemList[0]){
                                var articleCfg = document.createElement("div");
                                articleCfg.className = "articleCfgTitles";
                                articleCfg.innerHTML = itemCfgItemList[0];
                                document.getElementById("articleConfigBox").appendChild(articleCfg);
                                if (itemCfgItemList[1]){
                                    var articleCfg = document.createElement("div");
                                    articleCfg.className = "articleCfgItems";
                                    articleCfg.innerHTML = itemCfgItemList[1];
                                    document.getElementById("articleConfigBox").appendChild(articleCfg);
                                }
                            }
                        }
                    }

                    document.getElementById("articleIndex").innerHTML = itemIndex;

                    if(itemTag){
                        var itemTagsList = itemTag.split("\t");
                        for (l = 0; l < itemTagsList.length; l ++){
                            var articleTag = document.createElement("div");
                            articleTag.className = "articleTags";
                            articleTag.innerHTML = itemTagsList[l];
                            document.getElementById("articleTagBox").appendChild(articleTag);
                        }
                    }
                    
                    if(itemMain){
                        var hr = document.createElement("hr");
                        document.getElementById("article").appendChild(hr);
                        var itemPrghList = itemMain.split("$n");
                        for (l = 0; l < itemPrghList.length; l ++){
                            var tstart = false;
                            for (m = 0; m < itemPrghList[l].length; m ++){
                                if(itemPrghList[l][m] == "$"){
                                    m ++;
                                    if(itemPrghList[l][m] == "h"){
                                        if(!tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "<span style='font-size:24px'>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length)
                                            tstart = true;
                                        } else if(tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "</span>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length);
                                            tstart = false;
                                        }
                                    }
                                    if(itemPrghList[l][m] == "b"){
                                        if(!tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "<span style='font-weight:bolder'>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length)
                                            tstart = true;
                                        } else if(tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "</span>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length);
                                            tstart = false;
                                        }
                                    }
                                    if(itemPrghList[l][m] == "i"){
                                        if(!tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "<img src='./resources/items/item" + loadNum + "/media/" + itemPrghList[l].substring(m + 1,itemPrghList[l].length);
                                            tstart = true;
                                        } else if(tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "'>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length)
                                            tstart = false;
                                        }
                                    }
                                    if(itemPrghList[l][m] == "p"){
                                        if(!tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "<img src='" + itemPrghList[l].substring(m + 1,itemPrghList[l].length);
                                            tstart = true;
                                        } else if(tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "'>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length)
                                            tstart = false;
                                        }
                                    }
                                    if(itemPrghList[l][m] == "l"){
                                        if(!tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "<a href='" + itemPrghList[l].substring(m + 1,itemPrghList[l].length);
                                            tstart = m + 1;
                                        } else if(tstart){
                                            itemPrghList[l] = itemPrghList[l].substring(0,m - 1) + "' target='_blank'>" + itemPrghList[l].substring(tstart + 7,m - 1) + "</a>" + itemPrghList[l].substring(m + 1,itemPrghList[l].length)
                                            tstart = false;
                                        }
                                    }
                                }
                            }
                            var articlePrgh = document.createElement("p");
                            articlePrgh.innerHTML = itemPrghList[l].replace("$t","&nbsp;&nbsp;&nbsp;&nbsp;");
                            document.getElementById("article").appendChild(articlePrgh);
                        }
                    }
                    if(codeTry){
                        document.getElementById('codetry').style.display = "block";
                        document.getElementById('inputcode').innerHTML = codeTry;
                    }
                }
                else document.getElementById("articleIndex").innerHTML = "该文章已被禁用，无法访问！";
                setTimeout("winResize()",10);
            }
        } else document.getElementById("articleIndex").innerHTML = "请不要直接打开此页面，请点击左上角返回首页或打开index.html！";}
        
        function winResize() {
            var topBox = document.getElementById("articleTop");
            var topImg = document.getElementById("articleTopImg");
            var topIndex = document.getElementById("articleIndex");
            topImg.style.width = "calc(50% - 20px)";
            topImg.style.maxWidth = "780px";
            topImg.style.margin = "20px";
            topImg.style.float = "left";
            topBox.style.height = "auto";
			topBox.style.paddingLeft = "0px"
            if (topBox.offsetHeight - 40 > topImg.offsetHeight) {
                topImg.style.float = "none";
                topImg.style.width = "100%";
                topImg.style.maxWidth = "100%";
                topImg.style.margin = "0px";
                topImg.style.borderRadius = "0px"
				topBox.style.paddingLeft = "20px"
            } else {
                topImg.style.borderRadius = "20px"
                topBox.style.height = topImg.clientHeight + "px";
            }
        }
        window.onresize = winResize
    </script>
</head>
<body>
    <header>
        <button onclick="window.location.href = './index.html';">返回首页</button><span id="headerTitle"></span>
    </header>
    <main>
        <img id="articleTopImg"/>
        <div id="articleTop">
            <div id="articleTitle"></div>
            <div id="articleTagBox"></div>
        <div id="articleIndex"></div>
        </div>
        <div id="articleConfigBox"></div>
        <div id="article"></div>
        <div id="codetry">
            <p style="font-size:24px;color:#fff;margin-bottom:10px">代码体验（可编辑）</p>
            <textarea id="inputcode"></textarea>
            <button onclick="document.getElementById('preview').innerHTML = document.getElementById('inputcode').value" style="font-size:18px;color:#fff;border:0px;outline:0px;padding:10px 20px;margin:10px 0px;border-radius:20px;background-color:rgb(0, 89, 255)">预览效果</button>
            <div id="preview">点击上方按钮预览代码效果</div>
        </div>
    </main>
    <footer>
        
    </footer>
</body>
</html>